#!/bin/bash -e
LAST_RELEASE=$(git log --oneline --grep="Release human-review" -n 1 | cut -d' ' -f1)
if [ -z "$LAST_RELEASE" ]; then
    echo "No release commit found"
    exit 1
fi
CHANGES=$(git diff --stat "$LAST_RELEASE"..HEAD -- human_review/)
if [ -n "$CHANGES" ]; then
    echo "Unreleased changes since $LAST_RELEASE:"
    git log --oneline "$LAST_RELEASE"..HEAD -- human_review/
    exit 1
fi
echo "No unreleased changes"
