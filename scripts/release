#!/bin/bash
set -e

if [ -z "$1" ]; then
  echo "Usage: scripts/release <version>"
  echo "Example: scripts/release 0.2.0"
  exit 1
fi

VERSION="$1"
cd "$(dirname "$0")/../vscode"

# Update version in package.json
npm version "$VERSION" --no-git-tag-version

# Build and package
npm run build
npx vsce package

cd ..
git add vscode/package.json vscode/package-lock.json
git commit -m "Release v$VERSION"
git tag "v$VERSION"

echo ""
echo "Created release v$VERSION"
echo "Push with: git push origin master v$VERSION"
echo "Publish with: cd vscode && npx vsce publish"
