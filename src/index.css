@import "tailwindcss";
@import "tw-animate-css";
@import url('https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap');

@theme extend {
  --font-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-display: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;

  --text-xxs: 0.6875rem;
  --text-xxs--line-height: 1.5;
  --text-2xs: 0.75rem;
  --text-2xs--line-height: 1.5;

  --animate-fade-in: fade-in 0.2s ease-out forwards;
  --animate-slide-in: slide-in 0.2s ease-out forwards;
  --animate-accordion-down: accordion-down 0.2s ease-out;
  --animate-accordion-up: accordion-up 0.2s ease-out;
  --animate-sidebar-slide-in: sidebar-slide-in 0.25s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  --animate-sidebar-slide-out: sidebar-slide-out 0.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;

  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(0.267rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-in {
    from {
      opacity: 0;
      transform: translateX(-0.533rem);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes accordion-down {
    from {
      height: 0;
    }
    to {
      height: var(--radix-accordion-content-height);
    }
  }

  @keyframes accordion-up {
    from {
      height: var(--radix-accordion-content-height);
    }
    to {
      height: 0;
    }
  }

  @keyframes sidebar-slide-in {
    from {
      opacity: 0;
      transform: translateX(100%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes sidebar-slide-out {
    from {
      opacity: 1;
      transform: translateX(0);
    }
    to {
      opacity: 0;
      transform: translateX(100%);
    }
  }
}

@theme extend inline {
  /* Brand colors */
  --color-terracotta-400: #e0776b;
  --color-terracotta-500: #d45a52;
  --color-terracotta-600: #b54a42;
  --color-sage-200: #b5e0c2;
  --color-sage-300: #96c9a5;
  --color-sage-400: #7aad8a;
  --color-sage-500: #5a8f6d;
  --color-sage-600: #4a7459;

  /* shadcn/ui semantic colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  /* Border radii */
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);
}

/* Semantic design tokens — runtime-overridable for VS Code theme integration.
   These are NOT inline so they generate CSS variables that can be swapped at runtime.
   Dark defaults match the current stone palette exactly (zero visual change). */
@theme extend {
  /* Surfaces (backgrounds) */
  --color-surface: #0c0a09;            /* App shell, deepest background */
  --color-surface-inset: #1c1917;      /* Recessed areas (input fields, code blocks) */
  --color-surface-panel: #1c1917;      /* Panels, sidebars, modal backgrounds */
  --color-surface-raised: #292524;     /* Cards, sections, buttons (idle) */
  --color-surface-overlay: #292524;    /* Modals, dropdowns, popovers */
  --color-surface-hover: #44403c;      /* Hover state on interactive elements */
  --color-surface-active: #57534e;     /* Pressed/selected state */

  /* Text (foreground) */
  --color-fg: #fafaf9;                 /* Primary text — headings, emphasis */
  --color-fg-secondary: #d6d3d1;       /* Body text, labels */
  --color-fg-muted: #a19d99;           /* Metadata, hints, low-emphasis */
  --color-fg-faint: #918d89;           /* Disabled, placeholders */

  /* Borders */
  --color-edge: rgba(168, 162, 158, 0.15);    /* Subtle dividers */
  --color-edge-default: rgba(168, 162, 158, 0.25); /* Standard borders */
  --color-edge-strong: rgba(168, 162, 158, 0.4);   /* Emphasis borders */

  /* Interactive */
  --color-focus-ring: #d9923a;         /* Focus indicators (amber) */
  --color-selection: rgba(59, 130, 246, 0.3); /* Text selection background */
  --color-link: #22d3ee;               /* Hyperlink color (cyan-400) */

  /* Semantic status colors — review states (dark: 400 shade, light: 600 shade) */
  --color-status-approved: #34d399;    /* emerald-400 */
  --color-status-trusted: #2dd4bf;     /* teal-400 */
  --color-status-rejected: #fb7185;    /* rose-400 */
  --color-status-pending: #a8a29e;     /* stone-400 */
  --color-status-saved: #fbbf24;       /* amber-400 */

  /* Guide accent */
  --color-guide: #a78bfa;              /* violet-400 */

  /* Semantic status colors — file/change states */
  --color-status-added: #34d399;       /* emerald-400 (same as approved) */
  --color-status-modified: #fbbf24;    /* amber-400 */
  --color-status-deleted: #fb7185;     /* rose-400 (same as rejected) */
  --color-status-renamed: #38bdf8;     /* sky-400 */
  --color-status-untracked: #34d399;   /* emerald-400 */
  --color-status-moved: #38bdf8;       /* sky-400 */

  /* Semantic UI states */
  --color-status-warning: #fbbf24;     /* amber-400 */
  --color-status-info: #38bdf8;        /* sky-400 */

  /* Diff highlighting — theme-overridable */
  --color-diff-added: #7aad8a;         /* sage-400 */
  --color-diff-removed: #e0776b;       /* terracotta-400 */
}

:root {
  /* Accent colors - organic palette */
  --accent-amber: #d9923a;
  --accent-lime: #9cb43a;
  --accent-rose: #d95a52;
  --accent-sky: #4a9da8;
  --accent-cyan: #3aad9e;
  --accent-emerald: #4a9b70;
  --accent-violet: #9272c4;

  /* shadcn/ui tokens — derived from semantic tokens */
  --background: var(--color-surface);
  --foreground: var(--color-fg);
  --card: var(--color-surface-panel);
  --card-foreground: var(--color-fg);
  --popover: var(--color-surface-overlay);
  --popover-foreground: var(--color-fg);
  --primary: var(--accent-lime);
  --primary-foreground: var(--color-surface);
  --secondary: var(--color-surface-raised);
  --secondary-foreground: var(--color-fg-secondary);
  --muted: var(--color-surface-inset);
  --muted-foreground: var(--color-fg-muted);
  --accent: var(--color-surface-inset);
  --accent-foreground: var(--color-fg);
  --destructive: var(--accent-rose);
  --destructive-foreground: var(--color-fg);
  --border: var(--color-edge-default);
  --input: var(--color-edge-default);
  --ring: var(--color-focus-ring);
  --radius: 0.5rem;

  /* Typography - Inter with system fallback */
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  line-height: 1.5;
  font-weight: 400;
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Base styles */
html {
  color-scheme: dark;
}

body {
  background: var(--color-surface);
  color: var(--color-fg);
}

/* Code font size - set dynamically via JS */
:root {
  --code-font-size: 0.867rem;
  --ui-scale: 1;
}

/* Code font class */
.font-mono {
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  font-size: var(--code-font-size);
  line-height: 1.5;
  letter-spacing: -0.01em;
}

/* Scale the entire UI when font size changes (for presentations) */
html {
  font-size: calc(16px * var(--ui-scale));
}

/* Custom scrollbar */
/* Firefox */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: var(--color-surface-hover) transparent;
}

/* Chrome/Safari/Edge */
.scrollbar-thin::-webkit-scrollbar {
  width: 0.4rem;
  height: 0.4rem;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background: var(--color-surface-hover);
  border-radius: 0.2rem;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background: var(--color-surface-active);
}

/* Hide scrollbar while still allowing scroll */
/* Firefox */
.scrollbar-none {
  scrollbar-width: none;
}

/* Chrome/Safari/Edge */
.scrollbar-none::-webkit-scrollbar {
  display: none;
}

/* Button base */
.btn {
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-weight: 500;
  font-size: 0.875rem;
  transition: transform 0.15s ease;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-primary {
  background: var(--accent-lime);
  color: var(--color-surface);
}

.btn-primary:hover {
  background: color-mix(in srgb, var(--primary) 85%, white);
}

.btn-secondary {
  background: var(--color-surface-hover);
  color: var(--color-fg-secondary);
}

.btn-secondary:hover {
  background: var(--color-surface-active);
}

/* Guide start button — traveling shimmer + ambient glow */
.guide-start-button {
  position: relative;
  overflow: hidden;
  box-shadow:
    0 0 8px color-mix(in srgb, var(--color-guide) 20%, transparent),
    0 0 20px color-mix(in srgb, var(--color-guide) 8%, transparent);
}

.guide-start-button::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
    105deg,
    transparent 30%,
    color-mix(in srgb, var(--color-guide) 18%, transparent) 45%,
    color-mix(in srgb, var(--color-guide) 30%, transparent) 50%,
    color-mix(in srgb, var(--color-guide) 18%, transparent) 55%,
    transparent 70%
  );
  animation: guide-shimmer 3s ease-in-out infinite;
  pointer-events: none;
}

.guide-start-button:hover {
  box-shadow:
    0 0 12px color-mix(in srgb, var(--color-guide) 30%, transparent),
    0 0 28px color-mix(in srgb, var(--color-guide) 12%, transparent);
}

.guide-start-button:hover::before {
  animation-duration: 2s;
}

.guide-start-button:disabled::before {
  animation: none;
}

.guide-start-button .guide-sparkle {
  animation: guide-sparkle-pulse 2.5s ease-in-out infinite;
}

@keyframes guide-shimmer {
  0% { transform: translateX(-120%); }
  60% { transform: translateX(120%); }
  100% { transform: translateX(120%); }
}

@keyframes guide-sparkle-pulse {
  0%, 100% { opacity: 0.85; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.12); }
}

/* Guide floating sidebar panel — gradient border + layered glow */
.guide-floating-panel {
  border: 1px solid transparent;
  background-image:
    linear-gradient(
      color-mix(in srgb, var(--color-surface-panel) 95%, transparent),
      color-mix(in srgb, var(--color-surface-panel) 95%, transparent)
    ),
    linear-gradient(
      160deg,
      color-mix(in srgb, var(--color-guide) 30%, transparent),
      color-mix(in srgb, var(--color-guide) 8%, transparent) 40%,
      color-mix(in srgb, var(--color-guide) 25%, transparent)
    );
  background-clip: padding-box, border-box;
  background-origin: padding-box, border-box;
  box-shadow:
    /* Ground shadow */
    0 1px 3px rgba(0, 0, 0, 0.3),
    0 8px 20px rgba(0, 0, 0, 0.15),
    /* Purple ambient glow (matches guide-start-button intensity) */
    0 0 8px color-mix(in srgb, var(--color-guide) 18%, transparent),
    0 0 24px color-mix(in srgb, var(--color-guide) 10%, transparent),
    /* Inner top-edge highlight */
    inset 0 1px 0 color-mix(in srgb, var(--color-guide) 10%, transparent);
}

/* Animations */
@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(400%);
  }
}

@keyframes approve-pulse {
  0% {
    box-shadow: 0 0 0 0 color-mix(in srgb, var(--color-status-approved) 40%, transparent);
  }
  70% {
    box-shadow: 0 0 0 6px transparent;
  }
  100% {
    box-shadow: 0 0 0 0 transparent;
  }
}

@keyframes reject-pulse {
  0% {
    box-shadow: 0 0 0 0 color-mix(in srgb, var(--color-status-rejected) 40%, transparent);
  }
  70% {
    box-shadow: 0 0 0 6px transparent;
  }
  100% {
    box-shadow: 0 0 0 0 transparent;
  }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .animate-fade-in,
  .animate-slide-in {
    animation: none;
    opacity: 1;
    transform: none;
  }

  .animate-in {
    animation: none !important;
    opacity: 1;
    transform: none;
  }

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Input styling */
.input {
  background: var(--color-surface);
  border: 1px solid var(--color-edge-default);
  border-radius: 0.375rem;
  padding: 0.5rem 0.75rem;
  color: var(--color-fg);
  font-size: 0.875rem;
  transition: border-color 0.15s ease, box-shadow 0.15s ease;
}

.input::placeholder {
  color: var(--color-fg-faint);
}

.input:focus {
  outline: none;
  border-color: var(--color-focus-ring);
  box-shadow: 0 0 0 0.2rem color-mix(in srgb, var(--color-focus-ring) 10%, transparent);
}

/* Progress bar */
.progress-bar {
  position: relative;
  height: 0.25rem;
  background: var(--color-surface-raised);
  border-radius: 0.125rem;
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  background: var(--color-status-approved);
  border-radius: 0.125rem;
  transition: width 0.3s ease;
}

.progress-bar-trusted {
  position: absolute;
  height: 100%;
  background: var(--color-status-trusted);
  border-radius: 0.125rem 0 0 0.125rem;
  transition: width 0.3s ease;
}

.progress-bar-approved {
  position: absolute;
  height: 100%;
  background: var(--color-status-approved);
  border-radius: 0 0.125rem 0.125rem 0;
  transition: width 0.3s ease, left 0.3s ease;
}

.progress-bar-rejected {
  position: absolute;
  height: 100%;
  background: var(--color-status-rejected);
  border-radius: 0 0.125rem 0.125rem 0;
  transition: width 0.3s ease, left 0.3s ease;
}

/* Keyboard shortcut styling */
kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 1.25rem;
  height: 1.25rem;
  padding: 0 0.25rem;
  font-family: ui-monospace, monospace;
  font-size: 0.6875rem;
  font-weight: 500;
  color: var(--color-fg-secondary);
  background: var(--color-surface-raised);
  border: 1px solid var(--color-edge-default);
  border-radius: 0.25rem;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

/* Element-level resets — must be in @layer base so Tailwind utilities can override */
@layer base {
  /* Ensure form elements inherit font size for proper scaling */
  button, input, select, textarea {
    font-size: inherit;
  }

  /* Windows dark mode: ensure native form elements have proper colors */
  select, option, optgroup {
    background-color: var(--color-surface-raised);
    color: var(--color-fg);
  }

  option:checked {
    background-color: var(--color-surface-active);
  }

  optgroup {
    font-weight: 600;
    color: var(--color-fg-secondary);
  }

  /* Accessibility: prevent double-tap zoom delay on interactive elements */
  button, a, [role="button"] {
    touch-action: manipulation;
    cursor: pointer;
  }

  /* Ensure focus states are visible */
  :focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
  }

  /* Remove default focus outline when not using keyboard navigation */
  :focus:not(:focus-visible) {
    outline: none;
  }
}

/* Accessibility: override stone text colors for better contrast */
@utility text-stone-400 {
  color: #c7c4c0;
}
@utility text-stone-500 {
  color: #a19d99;
}
@utility text-stone-600 {
  color: #918d89;
}
@utility text-violet-400 {
  color: #c4b5fd;
}

/* File tree item optimization — skip layout/paint for off-screen nodes */
.file-node-item {
  content-visibility: auto;
  contain-intrinsic-size: 0 28px;
}

/* Image viewer styles */
.image-viewer-checkerboard {
  background-color: var(--color-surface-inset);
  background-image:
    linear-gradient(45deg, var(--color-surface-raised) 25%, transparent 25%),
    linear-gradient(-45deg, var(--color-surface-raised) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--color-surface-raised) 75%),
    linear-gradient(-45deg, transparent 75%, var(--color-surface-raised) 75%);
  background-size: 1rem 1rem;
  background-position: 0 0, 0 0.5rem, 0.5rem -0.5rem, -0.5rem 0;
}

.image-viewer-shadow {
  box-shadow: 0 0.267rem 1.333rem rgba(0, 0, 0, 0.4);
}

/* Image diff overlay slider */
.image-diff-slider {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 0.2rem;
  background: var(--color-fg);
  cursor: ew-resize;
  transform: translateX(-50%);
  z-index: 10;
}

.image-diff-slider::before,
.image-diff-slider::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
}

.image-diff-slider::before {
  top: 0;
  border-left: 0.4rem solid transparent;
  border-right: 0.4rem solid transparent;
  border-top: 0.5rem solid var(--color-fg);
}

.image-diff-slider::after {
  bottom: 0;
  border-left: 0.4rem solid transparent;
  border-right: 0.4rem solid transparent;
  border-bottom: 0.5rem solid var(--color-fg);
}

.image-diff-slider-handle {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 2rem;
  height: 2rem;
  background: var(--color-surface-overlay);
  border: 0.125rem solid var(--color-fg);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: ew-resize;
}

/* Subtle noise texture for depth */
.texture-noise {
  position: relative;
}

.texture-noise::after {
  content: '';
  position: absolute;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  opacity: 0.03;
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* Enhanced depth shadows */
.shadow-depth {
  box-shadow:
    0 0.25rem 0.5rem -0.125rem rgba(0, 0, 0, 0.3),
    0 0.5rem 1rem -0.25rem rgba(0, 0, 0, 0.2),
    inset 0 0.0625rem 0 color-mix(in srgb, var(--color-fg) 3%, transparent);
}

/* Glow effects */
.glow-sage {
  box-shadow: 0 0 1rem color-mix(in srgb, var(--color-diff-added) 30%, transparent);
}

.glow-terracotta {
  box-shadow: 0 0 1rem color-mix(in srgb, var(--color-diff-removed) 30%, transparent);
}

/* Interactive button affordance */
.btn-interactive {
  position: relative;
  overflow: hidden;
}

.btn-interactive::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, color-mix(in srgb, var(--color-fg) 20%, transparent) 0%, transparent 70%);
  opacity: 0;
  transform: scale(0.5);
  transition: opacity 0.2s, transform 0.3s;
}

.btn-interactive:hover::before {
  opacity: 1;
  transform: scale(1.5);
}

.btn-interactive:active::before {
  opacity: 0.5;
  transform: scale(2);
}

/* Markdown prose styling */
.markdown-prose {
  font-family: 'Georgia', 'Times New Roman', 'Iowan Old Style', 'Palatino Linotype', serif;
  font-size: 1.0625rem;
  line-height: 1.9;
  color: var(--color-fg-secondary);
  letter-spacing: 0.01em;
}

/* Headings: sans-serif contrast against serif body */
.markdown-prose h1,
.markdown-prose h2,
.markdown-prose h3,
.markdown-prose h4,
.markdown-prose h5,
.markdown-prose h6 {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
  letter-spacing: -0.02em;
  color: var(--color-fg);
  text-wrap: pretty;
}

.markdown-prose h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-top: 0;
  margin-bottom: 1.5rem;
}

.markdown-prose h2 {
  font-size: 1.875rem;
  font-weight: 600;
  margin-top: 3rem;
  margin-bottom: 1rem;
}

.markdown-prose h3 {
  font-size: 1.375rem;
  font-weight: 600;
  margin-top: 2.5rem;
  margin-bottom: 0.75rem;
}

.markdown-prose h4,
.markdown-prose h5,
.markdown-prose h6 {
  font-size: 1.125rem;
  font-weight: 600;
  margin-top: 2rem;
  margin-bottom: 0.5rem;
}

.markdown-prose p {
  margin-top: 0;
  margin-bottom: 1.25rem;
}

.markdown-prose a {
  color: var(--color-link);
  text-decoration: underline;
  text-decoration-color: color-mix(in srgb, var(--color-link) 30%, transparent);
  text-underline-offset: 3px;
}

.markdown-prose a:hover {
  text-decoration-color: var(--color-link);
}

.markdown-prose strong {
  font-weight: 700;
  color: var(--color-fg);
}

.markdown-prose em {
  font-style: italic;
}

.markdown-prose ul,
.markdown-prose ol {
  margin-top: 0;
  margin-bottom: 1.25rem;
  padding-left: 1.75rem;
}

.markdown-prose li {
  margin-bottom: 0.375rem;
}

.markdown-prose ul {
  list-style-type: disc;
}

.markdown-prose ol {
  list-style-type: decimal;
}

.markdown-prose li > ul,
.markdown-prose li > ol {
  margin-top: 0.25rem;
  margin-bottom: 0;
}

.markdown-prose blockquote {
  margin: 1rem 0;
  padding: 0.25rem 1.25rem;
  border-left: 2px solid var(--color-surface-active);
  font-style: italic;
  color: var(--color-fg-muted);
}

.markdown-prose blockquote p:last-child {
  margin-bottom: 0;
}

.markdown-prose hr {
  margin: 3rem auto;
  border: none;
  width: 4rem;
  height: 1px;
  background: var(--color-surface-active);
}

.markdown-prose table {
  width: 100%;
  margin: 1rem 0;
  border-collapse: collapse;
  font-size: 0.875rem;
}

.markdown-prose th,
.markdown-prose td {
  padding: 0.5rem 0.75rem;
  border: 1px solid var(--color-edge);
  text-align: left;
}

.markdown-prose th {
  background: transparent;
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
  font-size: 0.8125rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--color-fg-muted);
}

.markdown-prose img {
  max-width: 100%;
  height: auto;
  border-radius: 0.25rem;
  margin: 1rem 0;
}

/* Task list checkboxes (GFM) */
.markdown-prose input[type="checkbox"] {
  margin-right: 0.5rem;
  accent-color: var(--accent-lime);
}

.markdown-prose li:has(> input[type="checkbox"]) {
  list-style: none;
  margin-left: -1.75rem;
}

/* Definition lists */
.markdown-prose dl {
  margin: 1rem 0;
}

.markdown-prose dt {
  font-weight: 600;
  margin-top: 0.5rem;
}

.markdown-prose dd {
  margin-left: 1.75rem;
  color: var(--color-fg-secondary);
}

/* Strikethrough */
.markdown-prose del {
  text-decoration: line-through;
  color: var(--color-fg-muted);
}

/* Inline code */
.markdown-prose .markdown-inline-code {
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, monospace;
  font-size: 0.875em;
  background: color-mix(in srgb, var(--color-fg) 6%, transparent);
  color: var(--color-fg-secondary);
}

/* Code blocks */
.markdown-prose .markdown-block-code {
  font-size: 0.8125rem;
  background: color-mix(in srgb, var(--color-fg) 3%, transparent);
  border: 1px solid var(--color-edge);
  border-radius: 0.25rem;
}

/* Mermaid diagram container */
.markdown-prose .mermaid-container svg {
  max-width: 100%;
  height: auto;
}

/* Compact prose for sidebar panels (Guide section) */
.guide-prose {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', system-ui, sans-serif;
  font-size: 0.75rem;
  line-height: 1.5;
  color: var(--color-fg-secondary);
}

.guide-prose h1,
.guide-prose h2,
.guide-prose h3,
.guide-prose h4,
.guide-prose h5,
.guide-prose h6 {
  font-weight: 600;
  color: var(--color-fg);
  margin-top: 0.75rem;
  margin-bottom: 0.25rem;
  text-wrap: pretty;
}

.guide-prose h1 { font-size: 0.875rem; margin-top: 0; }
.guide-prose h2 { font-size: 0.8125rem; }
.guide-prose h3 { font-size: 0.75rem; }
.guide-prose h4,
.guide-prose h5,
.guide-prose h6 { font-size: 0.75rem; }

.guide-prose p {
  margin-top: 0;
  margin-bottom: 0.5rem;
}

.guide-prose p:last-child {
  margin-bottom: 0;
}

.guide-prose strong {
  font-weight: 600;
  color: var(--color-fg);
}

.guide-prose ul,
.guide-prose ol {
  margin-top: 0;
  margin-bottom: 0.5rem;
  padding-left: 1.25rem;
}

.guide-prose li {
  margin-bottom: 0.125rem;
}

.guide-prose ul { list-style-type: disc; }
.guide-prose ol { list-style-type: decimal; }

.guide-prose blockquote {
  margin: 0.5rem 0;
  padding: 0.125rem 0.75rem;
  border-left: 2px solid var(--color-surface-active);
  color: var(--color-fg-muted);
}

.guide-prose blockquote p:last-child {
  margin-bottom: 0;
}

.guide-prose hr {
  margin: 0.75rem 0;
  border: none;
  height: 1px;
  background: var(--color-surface-hover);
}

.guide-prose code {
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, monospace;
  font-size: 0.6875rem;
  background: color-mix(in srgb, var(--color-fg) 6%, transparent);
  color: var(--color-fg-secondary);
  padding: 0.1rem 0.3rem;
  border-radius: 0.2rem;
}

.guide-prose pre {
  margin: 0.5rem 0;
  padding: 0.5rem;
  background: color-mix(in srgb, var(--color-fg) 3%, transparent);
  border: 1px solid var(--color-edge);
  border-radius: 0.25rem;
  overflow-x: auto;
}

.guide-prose pre code {
  background: none;
  padding: 0;
}

.guide-prose table {
  width: 100%;
  margin: 0.5rem 0;
  border-collapse: collapse;
  font-size: 0.6875rem;
}

.guide-prose th,
.guide-prose td {
  padding: 0.25rem 0.5rem;
  border: 1px solid var(--color-edge);
  text-align: left;
}

.guide-prose th {
  font-weight: 600;
  color: var(--color-fg-muted);
}

.guide-prose input[type="checkbox"] {
  margin-right: 0.375rem;
  accent-color: var(--accent-lime);
}

.guide-prose li:has(> input[type="checkbox"]) {
  list-style: none;
  margin-left: -1.25rem;
}
